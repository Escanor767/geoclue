before_script:
    -  sed -i '/^#\sdeb-src /s/^#//' '/etc/apt/sources.list'
    - apt-get update && apt-get build-dep --yes geoclue-2.0
    - apt-get install --yes git gobject-introspection libmm-glib-dev wget libnotify-dev xsltproc gtk-doc-tools gettext modemmanager-dev

# Ubuntu 14.04 is not supported, see README for details

ubuntu-16.04:
    image: ubuntu:xenial
    artifacts:
        when: on_failure
        name: "xenial-${CI_COMMIT_REF_NAME}"
        paths:
            - "${CI_PROJECT_DIR}/build/meson-logs"
    script: ./autogen.sh --disable-nmea-source && make -j && make -j check && make install

ubuntu-17.10:
    image: ubuntu:artful
    artifacts:
        when: on_failure
        name: "artful-${CI_COMMIT_REF_NAME}"
        paths:
            - "${CI_PROJECT_DIR}/build/meson-logs"
    script: ./autogen.sh --disable-nmea-source && make -j && make -j check && make install

ubuntu-18.04:
    image: ubuntu:bionic
    artifacts:
        when: on_failure
        name: "bionic-${CI_COMMIT_REF_NAME}"
        paths:
            - "${CI_PROJECT_DIR}/build/meson-logs"
    script: ./autogen.sh --disable-nmea-source && make -j && make -j check && make install
